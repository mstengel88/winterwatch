import{d as v,r as l,j as e,g as ae,P as A,E as se,F as S,h as m,X as te,G as re,u as ne,p as oe,H as ie,B as x,J as R,U as le,K as ce}from"./index-BTTndiCa.js";import{R as de,T as me,P as ue,a as D,b as he,c as P,O as W,D as z,d as fe,e as pe,f as xe,g as ge,h as N,i as u}from"./index-C_FqIwIg.js";import{T as ve}from"./truck-GV-QDD0s.js";import{S as je}from"./shovel-CsAXD17G.js";import{S as ye,U as be,a as Ne}from"./user-MPZ2r4HK.js";import{L as I}from"./log-out-D3n32clD.js";import{C as we}from"./Combination-BI3QGdrN.js";import{C as Se}from"./clock-91DdfKYf.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=v("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=v("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=v("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=v("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=v("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=v("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);var O={exports:{}},T={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g=l;function Re(a,s){return a===s&&(a!==0||1/a===1/s)||a!==a&&s!==s}var Ie=typeof Object.is=="function"?Object.is:Re,_e=g.useState,De=g.useEffect,Pe=g.useLayoutEffect,We=g.useDebugValue;function ze(a,s){var t=s(),i=_e({inst:{value:t,getSnapshot:s}}),r=i[0].inst,n=i[1];return Pe(function(){r.value=t,r.getSnapshot=s,w(r)&&n({inst:r})},[a,t,s]),De(function(){return w(r)&&n({inst:r}),a(function(){w(r)&&n({inst:r})})},[a]),We(t),t}function w(a){var s=a.getSnapshot;a=a.value;try{var t=s();return!Ie(a,t)}catch{return!0}}function Oe(a,s){return s()}var Te=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Oe:ze;T.useSyncExternalStore=g.useSyncExternalStore!==void 0?g.useSyncExternalStore:Te;O.exports=T;var Ue=O.exports;function Ve(){return Ue.useSyncExternalStore(He,()=>!0,()=>!1)}function He(){return()=>{}}var L="Avatar",[Fe]=ae(L),[$e,U]=Fe(L),V=l.forwardRef((a,s)=>{const{__scopeAvatar:t,...i}=a,[r,n]=l.useState("idle");return e.jsx($e,{scope:t,imageLoadingStatus:r,onImageLoadingStatusChange:n,children:e.jsx(A.span,{...i,ref:s})})});V.displayName=L;var H="AvatarImage",F=l.forwardRef((a,s)=>{const{__scopeAvatar:t,src:i,onLoadingStatusChange:r=()=>{},...n}=a,h=U(H,t),c=qe(i,n),d=se(f=>{r(f),h.onImageLoadingStatusChange(f)});return S(()=>{c!=="idle"&&d(c)},[c,d]),c==="loaded"?e.jsx(A.img,{...n,ref:s,src:i}):null});F.displayName=H;var $="AvatarFallback",q=l.forwardRef((a,s)=>{const{__scopeAvatar:t,delayMs:i,...r}=a,n=U($,t),[h,c]=l.useState(i===void 0);return l.useEffect(()=>{if(i!==void 0){const d=window.setTimeout(()=>c(!0),i);return()=>window.clearTimeout(d)}},[i]),h&&n.imageLoadingStatus!=="loaded"?e.jsx(A.span,{...r,ref:s}):null});q.displayName=$;function _(a,s){return a?s?(a.src!==s&&(a.src=s),a.complete&&a.naturalWidth>0?"loaded":"loading"):"error":"idle"}function qe(a,{referrerPolicy:s,crossOrigin:t}){const i=Ve(),r=l.useRef(null),n=i?(r.current||(r.current=new window.Image),r.current):null,[h,c]=l.useState(()=>_(n,a));return S(()=>{c(_(n,a))},[n,a]),S(()=>{const d=b=>()=>{c(b)};if(!n)return;const f=d("loaded"),j=d("error");return n.addEventListener("load",f),n.addEventListener("error",j),s&&(n.referrerPolicy=s),typeof t=="string"&&(n.crossOrigin=t),()=>{n.removeEventListener("load",f),n.removeEventListener("error",j)}},[n,t,s]),h}var B=V,G=F,K=q;const k=l.forwardRef(({className:a,...s},t)=>e.jsx(B,{ref:t,className:m("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...s}));k.displayName=B.displayName;const Be=l.forwardRef(({className:a,...s},t)=>e.jsx(G,{ref:t,className:m("aspect-square h-full w-full",a),...s}));Be.displayName=G.displayName;const C=l.forwardRef(({className:a,...s},t)=>e.jsx(K,{ref:t,className:m("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...s}));C.displayName=K.displayName;const Ge=de,Ke=me,Je=ue,J=l.forwardRef(({className:a,...s},t)=>e.jsx(W,{className:m("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...s,ref:t}));J.displayName=W.displayName;const Xe=re("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),X=l.forwardRef(({side:a="right",className:s,children:t,...i},r)=>e.jsxs(Je,{children:[e.jsx(J,{}),e.jsxs(D,{ref:r,className:m(Xe({side:a}),s),...i,children:[t,e.jsxs(he,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-secondary hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[e.jsx(te,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));X.displayName=D.displayName;const Q=({className:a,...s})=>e.jsx("div",{className:m("flex flex-col space-y-2 text-center sm:text-left",a),...s});Q.displayName="SheetHeader";const Y=l.forwardRef(({className:a,...s},t)=>e.jsx(P,{ref:t,className:m("text-lg font-semibold text-foreground",a),...s}));Y.displayName=P.displayName;const Qe=l.forwardRef(({className:a,...s},t)=>e.jsx(z,{ref:t,className:m("text-sm text-muted-foreground",a),...s}));Qe.displayName=z.displayName;const Ye=[{href:"/dashboard",label:"Dashboard",icon:ve,roles:["driver","admin","manager"]},{href:"/shovel",label:"Shovel Crew",icon:je,roles:["shovel_crew","admin","manager"]},{href:"/work-logs",label:"Work Logs",icon:Ae,roles:["admin","manager"]},{href:"/admin/reports",label:"Reports",icon:Ce,roles:["admin","manager"]},{href:"/admin",label:"Admin",icon:ye,roles:["admin","manager"]}];function Ze(){var E;const{profile:a,signOut:s,hasRole:t,isAdminOrManager:i}=ne(),r=oe(),n=ie(),[h,c]=l.useState(!1),d=async()=>{await s(),r("/auth")},f=o=>{r(o),c(!1)},j=Ye.filter(o=>o.roles?o.roles.some(p=>t(p)):!0),b=((E=a==null?void 0:a.full_name)==null?void 0:E.split(" ").map(o=>o[0]).join("").slice(0,2).toUpperCase())||"U",y=(a==null?void 0:a.full_name)||(a==null?void 0:a.email)||"User",Z=y.length>12?y.slice(0,12)+"...":y,M=o=>o==="/dashboard"||o==="/shovel"?n.pathname===o:n.pathname.startsWith(o),ee=()=>i()||t("driver")?"/dashboard":t("shovel_crew")?"/shovel":"/";return e.jsx("header",{className:"sticky top-0 z-50 border-b border-border/40 bg-card/95 backdrop-blur supports-[backdrop-filter]:bg-card/60 pt-[env(safe-area-inset-top)]",children:e.jsxs("div",{className:"container flex h-14 items-center justify-between px-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(Ge,{open:h,onOpenChange:c,children:[e.jsx(Ke,{asChild:!0,children:e.jsx(x,{variant:"ghost",size:"icon",className:"md:hidden h-8 w-8",children:e.jsx(Le,{className:"h-5 w-5"})})}),e.jsxs(X,{side:"left",className:"w-72 p-0",children:[e.jsx(Q,{className:"border-b border-border/40 p-4",children:e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx("img",{src:R,alt:"WinterWatch-Pro",className:"h-8 w-8 rounded-full object-cover"}),e.jsx("span",{className:"font-semibold",children:"WinterWatch-Pro"})]})}),e.jsx("nav",{className:"flex flex-col p-4 space-y-1",children:j.map(o=>{const p=M(o.href);return e.jsxs(x,{variant:p?"secondary":"ghost",className:m("justify-start gap-3 h-11",p&&"bg-primary/10 text-primary border border-primary/30"),onClick:()=>f(o.href),children:[e.jsx(o.icon,{className:"h-5 w-5"}),o.label]},o.href)})}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 border-t border-border/40 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(k,{className:"h-10 w-10",children:e.jsx(C,{className:"bg-primary/20 text-primary",children:b})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:y}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:a==null?void 0:a.email})]})]}),e.jsxs(x,{variant:"outline",className:"w-full text-destructive border-destructive/30 hover:bg-destructive/10",onClick:d,children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Sign Out"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>r(ee()),children:[e.jsx("img",{src:R,alt:"WinterWatch-Pro",className:"h-8 w-8 rounded-full object-cover"}),e.jsx("span",{className:"font-semibold text-foreground hidden sm:inline",children:"WinterWatch-Pro"})]})]}),e.jsx("nav",{className:"hidden md:flex items-center gap-1",children:j.map(o=>{const p=M(o.href);return e.jsxs(x,{variant:p?"secondary":"ghost",size:"sm",onClick:()=>r(o.href),className:m("h-8 gap-2 text-sm",p&&"bg-primary/10 text-primary border border-primary/30"),children:[e.jsx(o.icon,{className:"h-4 w-4"}),o.label]},o.href)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground",children:e.jsx(ke,{className:"h-4 w-4"})}),e.jsxs(fe,{children:[e.jsx(pe,{asChild:!0,children:e.jsxs(x,{variant:"ghost",className:"h-8 gap-2 px-2",children:[e.jsx(k,{className:"h-6 w-6",children:e.jsx(C,{className:"bg-primary/20 text-primary text-xs",children:b})}),e.jsx("span",{className:"hidden sm:inline text-sm text-foreground",children:Z}),e.jsx(we,{className:"h-3 w-3 text-muted-foreground"})]})}),e.jsxs(xe,{align:"end",className:"w-48",children:[e.jsx(ge,{children:y}),e.jsx(N,{}),e.jsxs(u,{onClick:()=>r("/profile"),children:[e.jsx(be,{className:"mr-2 h-4 w-4"}),"Profile"]}),e.jsxs(u,{onClick:()=>r("/settings"),children:[e.jsx(Me,{className:"mr-2 h-4 w-4"}),"Settings"]}),i()&&e.jsxs(e.Fragment,{children:[e.jsx(N,{}),e.jsxs(u,{onClick:()=>r("/admin/users"),children:[e.jsx(Ne,{className:"mr-2 h-4 w-4"}),"Users & Roles"]}),e.jsxs(u,{onClick:()=>r("/admin/employees"),children:[e.jsx(le,{className:"mr-2 h-4 w-4"}),"Employees"]}),e.jsxs(u,{onClick:()=>r("/admin/accounts"),children:[e.jsx(ce,{className:"mr-2 h-4 w-4"}),"Accounts"]}),e.jsxs(u,{onClick:()=>r("/admin/equipment"),children:[e.jsx(Ee,{className:"mr-2 h-4 w-4"}),"Equipment"]}),e.jsxs(u,{onClick:()=>r("/time-clock"),children:[e.jsx(Se,{className:"mr-2 h-4 w-4"}),"Time Clock"]})]}),e.jsx(N,{}),e.jsxs(u,{onClick:d,className:"text-destructive",children:[e.jsx(I,{className:"mr-2 h-4 w-4"}),"Sign out"]})]})]})]})]})})}function la({children:a}){return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(Ze,{}),e.jsx("main",{className:"container px-4 py-6",children:a})]})}export{la as A,Ae as C,Me as S,k as a,C as b};
