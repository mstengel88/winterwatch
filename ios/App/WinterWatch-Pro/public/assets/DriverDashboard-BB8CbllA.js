import{r as a,s as N,u as ze,a as Qe,j as e,L as we,C as V,b as G,B as v,c as f,I as H}from"./index-BTTndiCa.js";import{u as Te,a as De,b as Ye,c as Je,d as Ke,C as Xe,L as Ne,N as ke,f as _e,P as Ze,e as Se}from"./distance-DgZguLxW.js";import{S as re,a as ae,b as ie,c as ne,d as ce,B as Ce}from"./select-CkuTWz4P.js";import{T as et}from"./textarea-hKNpP3I7.js";import{A as Ie}from"./AppLayout-CdmLHGoC.js";import{d as tt}from"./differenceInMinutes-CDNvr38S.js";import{S as Ee}from"./snowflake-Cz-A_SfV.js";import{C as oe}from"./clock-91DdfKYf.js";import{f as le}from"./format-D46ChU1D.js";import{P as st,T as rt}from"./timer-9Sr9DBrb.js";import{T as Le}from"./truck-GV-QDD0s.js";import{R as at}from"./refresh-cw-EZf9VRza.js";import"./differenceInMilliseconds-CqskIra_.js";import"./plus-DnkJBOXp.js";import"./Combination-BI3QGdrN.js";import"./index-C_FqIwIg.js";import"./shovel-CsAXD17G.js";import"./user-MPZ2r4HK.js";import"./log-out-D3n32clD.js";function it(m){const{employee:n}=Te(),{getCurrentLocation:u}=De(),[K,X]=a.useState([]),[k,h]=a.useState(null),[j,O]=a.useState([]),[z,o]=a.useState(!0),[Q,g]=a.useState(null),U=(m==null?void 0:m.employeeId)??(n==null?void 0:n.id),$=a.useCallback(async()=>{try{const{data:r,error:s}=await N.from("accounts").select("*").eq("is_active",!0).in("service_type",["plow","both"]).order("priority",{ascending:!0}).order("name",{ascending:!0});if(s)throw s;X(r||[])}catch(r){console.error("Error fetching accounts:",r),g("Failed to load accounts")}},[]),L=a.useCallback(async()=>{if(!U){h(null);return}try{const{data:r,error:s}=await N.from("work_logs").select(`
          *,
          account:accounts(*),
          equipment:equipment(*)
        `).eq("employee_id",U).eq("status","in_progress").order("check_in_time",{ascending:!1}).limit(1).maybeSingle();if(s)throw s;h(r)}catch(r){console.error("Error fetching active work log:",r)}},[U]),_=a.useCallback(async()=>{try{const r=new Date;r.setHours(0,0,0,0);const{data:s,error:l}=await N.from("work_logs").select(`
          *,
          account:accounts(*),
          employee:employees(first_name, last_name)
        `).gte("created_at",r.toISOString()).order("created_at",{ascending:!1}).limit(10);if(l)throw l;O(s||[])}catch(r){console.error("Error fetching recent work logs:",r)}},[]);return a.useEffect(()=>{(async()=>{o(!0),await $(),await L(),await _(),o(!1)})()},[$,L,_]),{accounts:K,activeWorkLog:k,recentWorkLogs:j,isLoading:z,error:Q,checkIn:async(r,s,l="both",p)=>{const T=p||(m==null?void 0:m.employeeId)||(n==null?void 0:n.id);if(!T)return g("No employee selected"),!1;const d=await u();try{const{data:S,error:b}=await N.from("work_logs").insert({account_id:r,employee_id:T,equipment_id:s||null,service_type:l,status:"in_progress",check_in_time:new Date().toISOString(),check_in_latitude:(d==null?void 0:d.latitude)??null,check_in_longitude:(d==null?void 0:d.longitude)??null}).select(`
          *,
          account:accounts(*),
          equipment:equipment(*)
        `).single();if(b)throw b;return h(S),await _(),!0}catch(S){return console.error("Error checking in:",S),g("Failed to check in"),!1}},checkOut:async r=>{if(!k)return g("No active work log found"),!1;const s=await u();try{const l={status:"completed",check_out_time:new Date().toISOString(),check_out_latitude:(s==null?void 0:s.latitude)??null,check_out_longitude:(s==null?void 0:s.longitude)??null,snow_depth_inches:r.snowDepthInches??null,salt_used_lbs:r.saltUsedLbs??null,weather_conditions:r.weatherConditions??null,notes:r.notes??null,photo_urls:r.photoUrls??null};r.equipmentId!==void 0&&(l.equipment_id=r.equipmentId||null),r.employeeId!==void 0&&(l.employee_id=r.employeeId),r.serviceType!==void 0&&(l.service_type=r.serviceType);const{error:p}=await N.from("work_logs").update(l).eq("id",k.id);if(p)throw p;return h(null),await _(),!0}catch(l){return console.error("Error checking out:",l),g("Failed to check out"),!1}},updateActiveWorkLog:async r=>{if(!k)return g("No active work log to update"),!1;try{const s={};if(r.equipmentId!==void 0&&(s.equipment_id=r.equipmentId||null),r.employeeId!==void 0&&(s.employee_id=r.employeeId),r.serviceType!==void 0&&(s.service_type=r.serviceType),Object.keys(s).length===0)return!0;const{error:l}=await N.from("work_logs").update(s).eq("id",k.id);if(l)throw l;return await L(),!0}catch(s){return console.error("Error updating work log:",s),g("Failed to update work log"),!1}},refreshData:async()=>{await $(),await L(),await _()}}}function M(m){return m.toString().padStart(2,"0")}function St(){var ve,je;const{profile:m}=ze(),{employee:n,activeShift:u,isLoading:K,clockIn:X,clockOut:k}=Te(),{location:h,getCurrentLocation:j,isLoading:O,error:z}=De(),{toast:o}=Qe(),{photos:Q,previews:g,isUploading:U,uploadProgress:$,addPhotos:L,removePhoto:_,clearPhotos:de,uploadPhotos:me,canAddMore:ue}=Ye({folder:"work-logs"});a.useEffect(()=>{j();const t=setInterval(()=>{j()},3e4);return()=>clearInterval(t)},[j]);const[y,r]=a.useState(""),[s,l]=a.useState("plow"),[p,T]=a.useState(""),[d,S]=a.useState(""),[b,he]=a.useState(""),[R,pe]=a.useState(""),[D,Pe]=a.useState("31"),[B,qe]=a.useState("Overcast"),[Y,We]=a.useState("7"),[xe,fe]=a.useState(""),[Z,Ae]=a.useState([]),[P,Fe]=a.useState([]),[ee,ge]=a.useState({hours:0,minutes:0,seconds:0}),[te,ye]=a.useState({hours:0,minutes:0,seconds:0});a.useMemo(()=>{if(!d)return n?`${n.first_name} ${n.last_name}`:"Employee";const t=P.find(i=>i.id===d);return t?`${t.first_name} ${t.last_name}`:"Employee"},[d,n,P]);const{accounts:C,activeWorkLog:x,recentWorkLogs:I,isLoading:Me,checkIn:Oe,checkOut:Ue}=it({employeeId:n==null?void 0:n.id});Je({temperature:D,conditions:B,jobsCompleted:I.length,isCheckedIn:!!x,currentLocation:y?(ve=C.find(t=>t.id===y))==null?void 0:ve.name:void 0});const se=a.useMemo(()=>{let t;return s==="plow"?t=Z.filter(i=>i.service_type==="plow"||i.service_type==="both"):t=Z.filter(i=>i.service_type==="both"),t.sort((i,c)=>{var W,A,F,be;const E=parseInt(((A=(W=i.name)==null?void 0:W.match(/\d+/))==null?void 0:A[0])||"0",10);return parseInt(((be=(F=c.name)==null?void 0:F.match(/\d+/))==null?void 0:be[0])||"0",10)-E})},[Z,s]);a.useEffect(()=>{p&&(se.some(i=>i.id===p)||T(""))},[s,se,p]),a.useEffect(()=>{N.from("equipment").select("*").eq("is_active",!0).eq("status","available").then(({data:t})=>{t&&Ae(t)}),N.from("employees").select("*").in("category",["plow","both"]).eq("is_active",!0).order("first_name").then(({data:t})=>{t&&Fe(t)})},[]),a.useEffect(()=>{if(m!=null&&m.email&&P.length>0&&!d){const t=P.find(i=>{var c,E;return((c=i.email)==null?void 0:c.toLowerCase())===((E=m.email)==null?void 0:E.toLowerCase())});t&&S(t.id)}},[m==null?void 0:m.email,P,d]),a.useEffect(()=>{if(!u){ge({hours:0,minutes:0,seconds:0});return}const t=()=>{const c=new Date(u.clock_in_time),w=Se(new Date,c),W=Math.floor(w/3600),A=Math.floor(w%3600/60),F=w%60;ge({hours:W,minutes:A,seconds:F})};t();const i=setInterval(t,1e3);return()=>clearInterval(i)},[u]),a.useEffect(()=>{if(!x||!x.check_in_time){ye({hours:0,minutes:0,seconds:0});return}const t=()=>{const c=new Date(x.check_in_time),w=Se(new Date,c),W=Math.floor(w/3600),A=Math.floor(w%3600/60),F=w%60;ye({hours:W,minutes:A,seconds:F})};t();const i=setInterval(t,1e3);return()=>clearInterval(i)},[x]);const J=a.useMemo(()=>!h||C.length===0?C.map(t=>({...t,distance:void 0})):C.map(t=>{let i;return t.latitude&&t.longitude&&(i=Ke(h.latitude,h.longitude,t.latitude,t.longitude)),{...t,distance:i}}).sort((t,i)=>t.distance!==void 0&&i.distance!==void 0?t.distance-i.distance:t.distance!==void 0?-1:i.distance!==void 0?1:t.name.localeCompare(i.name)),[h,C]),q=a.useMemo(()=>{if(J.length===0)return null;const t=J[0];return t.distance!==void 0?{account:t,distance:t.distance}:null},[J]);a.useEffect(()=>{q&&!y&&r(q.account.id)},[q,y]);const $e=a.useCallback(async()=>{await j(),o({title:"Location updated"})},[j,o]);a.useMemo(()=>{const t=I.filter(c=>c.service_type==="plow"||c.service_type==="both").length,i=I.filter(c=>c.service_type==="salt"||c.service_type==="both").length;return{total:I.length,plowed:t,salted:i,accounts:C.length}},[I,C]);const Re=a.useMemo(()=>u?(tt(new Date,new Date(u.clock_in_time))/60).toFixed(1):"0.0",[u]),Be=async()=>{await X()?(o({title:"Shift started!"}),j()):o({variant:"destructive",title:"Failed to start shift"})},Ve=async()=>{const t=await k();o(t?{title:"Shift ended!"}:{variant:"destructive",title:"Failed to end shift"})},Ge=async()=>{if(!y){o({variant:"destructive",title:"Please select an account"});return}if(!u){o({variant:"destructive",title:"Please start your shift first"});return}if(!d){o({variant:"destructive",title:"Please select an employee"});return}const t=d==="self"?n==null?void 0:n.id:d;if(!t){o({variant:"destructive",title:"Employee not found"});return}const i=await Oe(y,p||void 0,s,t);o(i?{title:"Checked in!"}:{variant:"destructive",title:"Failed to check in"})},He=async()=>{const t=[];if(p||t.push("Equipment"),d||t.push("Employees"),(s==="plow"||s==="both")&&(!b||b.trim()==="")&&t.push("Snow Depth"),(s==="salt"||s==="both")&&(!R||R.trim()==="")&&t.push("Salt Used"),(!D||D.trim()==="")&&t.push("Temperature"),(!B||B.trim()==="")&&t.push("Weather"),(!Y||Y.trim()==="")&&t.push("Wind Speed"),t.length>0){o({variant:"destructive",title:"Required fields missing",description:`Please fill in: ${t.join(", ")}`});return}let i=[];Q.length>0&&x&&(i=await me(x.id));const c=d||(n==null?void 0:n.id);await Ue({snowDepthInches:b?parseFloat(b):void 0,saltUsedLbs:R?parseFloat(R):void 0,weatherConditions:`${D}°F ${B} Wind: ${Y}mph`,notes:xe,photoUrls:i,equipmentId:p||void 0,employeeId:c,serviceType:s})?(o({title:"Work completed!"}),fe(""),he(""),pe(""),T(""),S(""),de()):o({variant:"destructive",title:"Failed to check out"})};return K||Me?e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-background",children:e.jsx(we,{className:"h-8 w-8 animate-spin text-primary"})}):n?e.jsx(Ie,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-primary/20",children:e.jsx(Ee,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-xl font-semibold flex items-center gap-2",children:["WinterWatch-Pro",e.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:[D,"°F"]})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Welcome back, ",n.first_name," ",n.last_name,"! Track your plowing and salting services."]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"This Week"}),e.jsxs("p",{className:"flex items-center justify-end gap-1.5 text-lg font-semibold text-success",children:[e.jsx(oe,{className:"h-4 w-4"}),Re,"h"]})]})]}),e.jsx(V,{className:"bg-[hsl(var(--card))]/80 border-border/50",children:e.jsx(G,{className:"py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/20 flex items-center justify-center",children:e.jsx(oe,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Daily Shift"}),u?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-lg font-mono font-bold text-primary",children:[M(ee.hours),":",M(ee.minutes),":",M(ee.seconds)]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Started ",le(new Date(u.clock_in_time),"h:mm a")]})]}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"Shift not started"})]})]}),u?e.jsxs(v,{onClick:Ve,variant:"outline",className:"border-red-500/50 text-red-400 hover:bg-red-500/20",children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"End Shift"]}):e.jsxs(v,{onClick:Be,className:"bg-primary hover:bg-primary/90",children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Start Shift"]})]})})}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mb-3 text-base font-semibold",children:"Quick Log Entry"}),e.jsxs("div",{className:"bg-primary rounded-lg p-4 flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ke,{className:"h-5 w-5 text-primary-foreground/70"}),e.jsx("div",{children:O?e.jsxs("p",{className:"font-medium text-primary-foreground flex items-center gap-2",children:[e.jsx(we,{className:"h-4 w-4 animate-spin"}),"Getting location..."]}):z?e.jsx("p",{className:"font-medium text-primary-foreground",children:z}):q?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"font-medium text-primary-foreground",children:[e.jsx("span",{className:"text-primary-foreground/70",children:"Nearest:"})," ",q.account.name," ",e.jsx("span",{className:"text-primary-foreground/70",children:_e(q.distance)})]}),e.jsxs("p",{className:"text-sm text-primary-foreground/70",children:["GPS accuracy: ±",((je=h==null?void 0:h.accuracy)==null?void 0:je.toFixed(0))||0," meters"]})]}):e.jsx("p",{className:"font-medium text-primary-foreground",children:"No accounts with coordinates found"})})]}),e.jsx(v,{variant:"ghost",size:"icon",onClick:$e,disabled:O,className:"text-primary-foreground hover:bg-primary-foreground/20",children:e.jsx(ke,{className:`h-5 w-5 ${O?"animate-pulse":""}`})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(f,{className:"text-sm text-muted-foreground",children:"Select Account (verify or change)"}),e.jsxs(re,{value:y,onValueChange:r,disabled:!!x,children:[e.jsx(ae,{className:"mt-1.5 bg-secondary border-primary/30 focus:border-primary focus:ring-primary/20",children:e.jsx(ie,{placeholder:"Select account..."})}),e.jsx(ne,{className:"bg-card border-primary/30",children:J.filter(t=>t.id&&t.id.trim()!=="").map(t=>e.jsx(ce,{value:t.id,children:e.jsxs("div",{className:"flex items-center justify-between w-full gap-2",children:[e.jsx("span",{children:t.name}),t.distance!==void 0&&e.jsx("span",{className:"text-xs text-muted-foreground ml-2",children:_e(t.distance)})]})},t.id))})]})]}),x?e.jsx(V,{className:"mb-4 border-primary/50 bg-primary/10",children:e.jsx(G,{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-primary",children:"Currently working at location"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Started ",le(new Date(x.check_in_time),"h:mm a")]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(rt,{className:"h-4 w-4 text-primary"}),e.jsxs("span",{className:"text-lg font-mono font-bold text-primary",children:[M(te.hours),":",M(te.minutes),":",M(te.seconds)]})]})]})})}):e.jsxs(e.Fragment,{children:[e.jsxs(v,{className:"w-full justify-center bg-primary hover:bg-primary/90 text-primary-foreground mb-3",onClick:Ge,disabled:!u||!y,children:[e.jsx(st,{className:"h-4 w-4 mr-2"}),"Check In & Start Timer"]}),!u&&e.jsxs("p",{className:"text-center text-sm mb-4",children:[e.jsx("span",{className:"text-red-400",children:"Start your "}),e.jsx("span",{className:"text-yellow-400",children:"daily shift"}),e.jsx("span",{className:"text-red-400",children:" first via Time Clock"})]})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx(f,{className:"text-sm",children:"Service Type"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs(v,{variant:s==="plow"?"default":"ghost",className:s==="plow"?"bg-primary hover:bg-primary/90 text-primary-foreground":"bg-transparent hover:bg-muted/30",onClick:()=>l("plow"),children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),"Plow Only"]}),e.jsxs(v,{variant:s==="salt"?"default":"ghost",className:s==="salt"?"bg-primary hover:bg-primary/90 text-primary-foreground":"bg-transparent hover:bg-muted/30",onClick:()=>l("salt"),children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"Salt Only"]}),e.jsxs(v,{variant:s==="both"?"default":"ghost",className:s==="both"?"bg-primary hover:bg-primary/90 text-primary-foreground":"bg-transparent hover:bg-muted/30",onClick:()=>l("both"),children:[e.jsx(at,{className:"h-4 w-4 mr-2"}),"Plow & Salt"]})]})]}),e.jsxs("div",{className:"mb-4 grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs(f,{className:"text-sm text-muted-foreground",children:["Equipment ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs(re,{value:p,onValueChange:T,children:[e.jsx(ae,{className:"mt-1.5 bg-secondary border-primary/30 focus:border-primary focus:ring-primary/20",children:e.jsx(ie,{placeholder:"Select equipment..."})}),e.jsx(ne,{className:"bg-card border-primary/30",children:se.filter(t=>t.id&&t.id.trim()!=="").map(t=>e.jsx(ce,{value:t.id,children:t.name},t.id))})]})]}),e.jsxs("div",{children:[e.jsxs(f,{className:"text-sm text-muted-foreground",children:["Employees ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs(re,{value:d,onValueChange:S,children:[e.jsx(ae,{className:"mt-1.5 bg-secondary border-primary/30 focus:border-primary focus:ring-primary/20",children:e.jsx(ie,{placeholder:"Select employees..."})}),e.jsx(ne,{className:"bg-card border-primary/30",children:P.filter(t=>t.id&&t.id.trim()!=="").map(t=>e.jsxs(ce,{value:t.id,children:[t.first_name," ",t.last_name]},t.id))})]})]})]}),e.jsxs("div",{className:"mb-4 grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs(f,{className:"text-sm text-muted-foreground",children:["Snow Depth (inches) ",(s==="plow"||s==="both")&&e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx(H,{type:"number",placeholder:"e.g., 3.5",value:b,onChange:t=>he(t.target.value),className:"mt-1.5 bg-secondary border-primary/30 focus:border-primary focus-visible:ring-primary/20"})]}),e.jsxs("div",{children:[e.jsxs(f,{className:"text-sm text-muted-foreground",children:["Salt Used (lbs) ",(s==="salt"||s==="both")&&e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx(H,{type:"number",placeholder:"e.g., 150",value:R,onChange:t=>pe(t.target.value),className:"mt-1.5 bg-secondary border-primary/30 focus:border-primary focus-visible:ring-primary/20"})]})]}),e.jsxs("div",{className:"mb-4 grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsxs(f,{className:"text-sm text-muted-foreground flex items-center gap-1",children:["Temp (°F) ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx(H,{type:"number",value:D,onChange:t=>Pe(t.target.value),className:"mt-1.5 bg-secondary border-primary/30 focus:border-primary focus-visible:ring-primary/20"})]}),e.jsxs("div",{children:[e.jsxs(f,{className:"text-sm text-muted-foreground flex items-center gap-1",children:["Weather ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx(H,{value:B,onChange:t=>qe(t.target.value),className:"mt-1.5 bg-secondary border-primary/30 focus:border-primary focus-visible:ring-primary/20"})]}),e.jsxs("div",{children:[e.jsxs(f,{className:"text-sm text-muted-foreground flex items-center gap-1",children:["Wind (mph) ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx(H,{type:"number",value:Y,onChange:t=>We(t.target.value),className:"mt-1.5 bg-secondary border-primary/30 focus:border-primary focus-visible:ring-primary/20"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(f,{className:"text-sm text-muted-foreground",children:"Notes (Optional)"}),e.jsx(et,{placeholder:"Any additional notes...",value:xe,onChange:t=>fe(t.target.value),className:"mt-1.5 bg-secondary border-primary/30 focus:border-primary focus-visible:ring-primary/20 min-h-[80px]"})]}),e.jsx("div",{className:"mb-4",children:e.jsx(Ze,{photos:Q,previews:g,isUploading:U,uploadProgress:$,canAddMore:ue,onAddPhotos:L,onRemovePhoto:_})}),x?e.jsx(v,{className:"w-full bg-primary hover:bg-primary/90 text-primary-foreground",onClick:He,children:"Check Out & Complete"}):e.jsx(v,{className:"w-full bg-primary/50 hover:bg-primary/40 text-primary-foreground cursor-not-allowed",disabled:!0,children:"Check In First"})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"mb-3 text-base font-semibold",children:"Recent Activity"}),I.length===0?e.jsx(V,{className:"border-border/50 bg-card",children:e.jsxs(G,{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(oe,{className:"mb-3 h-10 w-10 text-muted-foreground/50"}),e.jsx("p",{className:"font-medium text-muted-foreground",children:"No activity yet"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Start logging your work!"})]})}):e.jsx(V,{className:"border-border/50 bg-card",children:e.jsx(G,{className:"py-2 px-0",children:e.jsx("div",{className:"divide-y divide-border",children:I.map(t=>{var c;const i=t.status==="in_progress"||t.check_in_time&&!t.check_out_time;return e.jsxs("div",{className:`flex items-start gap-3 py-3 px-4 ${i?"bg-primary/5":""}`,children:[e.jsx("div",{className:`flex h-8 w-8 items-center justify-center rounded-lg mt-0.5 ${i?"bg-warning/20":"bg-primary/20"}`,children:e.jsx(Le,{className:`h-4 w-4 ${i?"text-warning":"text-primary"}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("p",{className:"font-medium text-sm",children:((c=t.account)==null?void 0:c.name)||"Unknown"}),i?e.jsxs(Ce,{className:"bg-warning/20 text-warning border-warning/30 text-xs px-2 py-0.5",children:[e.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-warning mr-1.5 animate-pulse"}),"In Progress"]}):e.jsx(Ce,{className:"bg-success text-success-foreground text-xs px-2 py-0.5",children:t.service_type==="plow"?"Plowed":t.service_type==="salt"?"Salted":"Both"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-0.5",children:[le(new Date(t.check_in_time||t.created_at),"MMM d, h:mm a")," • ",t.employee?`${t.employee.first_name} ${t.employee.last_name}`:"Unknown"]}),t.notes&&e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:t.notes})]})]},t.id)})})})})]})]})]})}):e.jsx(Ie,{children:e.jsx(V,{className:"border-warning bg-card",children:e.jsx(G,{className:"py-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Xe,{className:"h-5 w-5 text-warning"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Employee Record Not Found"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Your user account is not linked to an employee record. Please contact your manager."})]})]})})})})}export{St as default};
